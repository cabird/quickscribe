Please improve the code by considering the following suggestions.  If some of these have already been addressed in the code, then
don't make any changes with regard to that concern.

1. **Error Handling**: Enhance error handling to provide more specific and actionable error messages. Use custom exceptions where appropriate.

2. **Logging**: Implement logging instead of print statements for better traceability and debugging.

3. **Code Duplication**: Reduce code duplication by creating reusable functions for common operations, such as querying the database.

4. **Type Annotations**: Ensure all functions have complete type annotations for better readability and maintainability.

5. **Documentation**: Add more detailed docstrings to explain the purpose and usage of each function and class.

6. **Configuration Management**: Use environment variables or a configuration management library to handle sensitive information like database credentials.

7. **Testing**: Ensure there are unit tests for all critical functions to maintain code quality and reliability.

8. **Dependency Injection**: Use dependency injection to make the code more testable and flexible.
